# 1.1 Hello, Metal!

你已经正式了解了 Metal，并了解了它的历史以及为什么要使用它。现在，你将在 Swift 游乐场中亲自尝试一下。首先，你将在屏幕上渲染此球体：

<figure><img src="../.gitbook/assets/image.png" alt="" width="375"><figcaption></figcaption></figure>

它看起来可能并不令人兴奋，但这是一个很好的起点，因为练习涉及渲染过程的几乎每个部分。但在开始之前，了解渲染(Rendering)和帧(Frames)这两个术语很重要。

## 什么是渲染(Rendering)？

在 3D 计算机图形学中，你需要获取一堆点，将它们连接在一起并在屏幕上创建图像。此图像称为渲染。

从点渲染图像涉及计算屏幕上每个像素的亮度和阴影。光线在场景中反射，因此你必须决定照明的复杂程度以及每幅图像的渲染时间。皮克斯电影中的单个图像可能需要几天才能渲染，但游戏需要实时渲染，你可以立即看到图像。

渲染 3D 图像的方法有很多，但大多数都是从在 Blender 或 Maya 等建模应用程序中构建的模型开始的。例如，这个在 Blender 中构建的火车模型：

<figure><img src="../.gitbook/assets/image (1).png" alt="" width="375"><figcaption></figcaption></figure>

与所有其他模型一样，此模型由顶点(Vertices)组成。顶点是指三维空间中两个或多个直线、曲线或几何形状的边缘相交的点，例如立方体的角。模型中的顶点数量可能从立方体中的几个到更复杂模型中的数千甚至数百万不等。

3D 渲染器(Renderer)将使用模型加载器代码(Model Loader Code)读取这些顶点，该代码解析顶点列表。然后，渲染器将顶点传递给 GPU，着色器函数(Shader Functions)处理顶点以创建最终图像或纹理，并将其发送回 CPU 并显示在屏幕上。

以下渲染使用 3D 火车模型和一些不同的着色技术，使火车看起来像是用闪亮的铜制成的：

<figure><img src="../.gitbook/assets/image (2).png" alt="" width="375"><figcaption></figcaption></figure>

从导入模型顶点到在屏幕上生成最终图像的整个过程通常称为渲染管道(Rendering Pipeline)。渲染管道是发送到 GPU 的命令列表，以及构成最终图像的资源(顶点、材质(Materials)和灯光(Lights))。

管道包括可编程和不可编程功能。管道的可编程部分称为顶点函数(Vertex Functions)和片段函数(Fragment Functions)，您可以在其中手动影响渲染模型的最终外观。您将在本书后面详细了解每个函数。

## 什么是帧(Frames)？

如果游戏所做的只是渲染单个静止图像，那么游戏就没什么乐趣。流畅地在屏幕上移动角色需要 GPU 每秒渲染大约六十次静止图像。每个静止图像称为一帧，图像出现的速度称为帧速率(Frame Rate)。

当你最喜欢的游戏出现卡顿时，通常是因为帧速率降低，尤其是当过多的后台处理消耗 GPU 时。在设计游戏时，重要的是平衡您想要的结果和硬件可以提供的结果。

虽然添加实时阴影、水反射和数百万片动画草叶可能很酷 - 你将在本书中学习如何做到这一点 - 但在 1/60 秒内可能实现的内容和 GPU 可以处理的内容之间找到适当的平衡可能很困难。

## 你的第一个 Metal 应用

在你的第一个 Metal 应用中，你要渲染的形状看起来更像是一个平面圆，而不是 3D 球体。这是因为你的第一个模型不包含任何透视或阴影。但是，其顶点网格包含完整的三维信息。

无论你的应用大小和复杂程度如何，Metal 渲染的过程都大体相同，你将非常熟悉在屏幕上绘制模型的以下顺序：

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

你最初可能会对 Metal 所需的步骤数量感到有些不知所措，但不用担心。你将始终按照相同的顺序执行这些步骤，它们将逐渐成为您的第二天性。

本章不会详细介绍每个步骤，但随着你阅读本书的进度，你将根据需要获得更多信息。现在，请集中精力运行你的第一个 Metal 应用。

